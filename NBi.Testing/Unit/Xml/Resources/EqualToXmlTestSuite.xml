<?xml version="1.0" encoding="utf-8" ?>
<testSuite name="The Query TestSuite" xmlns="http://NBi/TestSuite">
	<settings>
		<default apply-to="system-under-test">
			<connectionString>Data Source=mhknbn2kdz.database.windows.net;Initial Catalog=AdventureWorks2012;User Id=sqlfamily;password=sqlf@m1ly</connectionString>
		</default>
	</settings>
	<test name="My first test case" uid="0001">
		<system-under-test>
			<execution>
				<query name="Select first departments">
					select top 2 [DepartmentID], [Name], [GroupName] from [HumanResources].[Department] order by Name
				</query>
			</execution>
		</system-under-test>
		<assert>
			<equalTo>
				<resultSet>
					<row>
						<cell>12</cell>
						<cell>Document Control</cell>
						<cell>Quality Assurance</cell>
					</row>
					<row>
						<cell>1</cell>
						<cell>Engineering</cell>
						<cell>Research and Development</cell>
					</row>
				</resultSet>
			</equalTo>
		</assert>
	</test>
	<test name="external resultSet file">
		<system-under-test>
			<execution>
				<query name="Select first departments">
					select top 2 [DepartmentID], [Name], [GroupName] from [HumanResources].[Department] order by Name
				</query>
			</execution>
		</system-under-test>
		<assert>
			<equalTo>
				<resultSet file="Query.csv"/>
			</equalTo>
		</assert>
	</test>
	<test name="keys">
		<system-under-test>
			<execution>
				<query>
					select top 2 [DepartmentID], [Name], [GroupName] from [HumanResources].[Department] order by Name;
				</query>
			</execution>
		</system-under-test>
		<assert>
			<equalTo keys="first">
				<resultSet file="Query.csv"/>
			</equalTo>
		</assert>
	</test>
	<test name="values">
		<system-under-test>
			<execution>
				<query>
					select top 2 [DepartmentID], [Name], [GroupName] from [HumanResources].[Department] order by Name
				</query>
			</execution>
		</system-under-test>
		<assert>
			<equalTo>
				<column-definition role="value" index="3" type="numeric" tolerance="10"/>
				<query file="Query.sql"/>
			</equalTo>
		</assert>
	</test>
	<test name="values">
		<system-under-test>
			<execution>
				<query>
					select top 2 [Name], [GroupName], [DepartmentID] from [HumanResources].[Department] order by Name
				</query>
			</execution>
		</system-under-test>
		<assert>
			<equalTo>
				<query connectionString="Data Source=Reference;Initial Catalog=AdventureWorks2012;User Id=sqlfamily;password=sqlf@m1ly">
					select top 2 [Name], [GroupName], [DepartmentID] from [HumanResources].[Department] order by Name
				</query>
			</equalTo>
		</assert>
	</test>
  <test name="equalTo values and tolerance">
    <system-under-test>
		<execution>
			  <query>
				  select top 2 [Name], [GroupName], [DepartmentID] from [HumanResources].[Department] order by Name
			  </query>
		</execution>
    </system-under-test>
    <assert>
      <equalTo values="last" tolerance="100">
        <query file="Query.sql"/>
      </equalTo>
    </assert>
  </test>
	<test name="equalTo Persistance">
		<system-under-test>
			<execution>
				<query>
					select top 2 [DepartmentID], [Name], [GroupName] from [HumanResources].[Department] order by Name
				</query>
			</execution>
		</system-under-test>
		<assert>
			<equalTo persistance="only-if-failed">
				<resultSet file="Query.csv"/>
			</equalTo>
		</assert>
	</test>
</testSuite>
